<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" type="text/css" href="./static/js/grid.css">
    <meta charset="utf-8">
    <title>WORDLE</title>
    <style type="text/css">
    * {
        margin: 0;
        padding: 0;
        font-family: 'Clear Sans', 'Helvetica Neue', Arial, sans-serif;
    }

    header {
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
        width: 100%;
        border-bottom: 1px solid black;

    }

    #title {
        font-weight: 700;
        font-size: 36px;
        letter-spacing: 0.2rem;
        text-transform: uppercase;
        text-align: center;
    }

    .letterbox {
        width: 62px;
        height: 62px;
        border: 1px solid black;
        margin-right: 5px;
        margin-bottom: 5px;
    }

    .flex {
        display: flex;
    }

    #all {
        flex-direction: column;
        align-items: center;
        justify-content: space-between;
    }

    #midcontainer .row {

        margin-left: auto;
        margin-right: auto;
        margin-top: 9px;
        display: flex;
        justify-content: space-between;
    }

    .letterbox {
        box-sizing: border-box;
        width: 60px;
        height: 60px;
        border: 2px solid #ddd;
        font-size: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: Helvetica, sans-serif;
        text-transform: uppercase;
        font-weight: 700;
    }

    #keyboard {
        max-width: 500px;
        margin-left: auto;
        margin-right: auto;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
    }

    .button {
        background-color: #d3d6da;
        box-sizing: border-box;
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 4px;
        height: 60px;
        width: 43px;
        outline: none;
        border: none;
        padding: 0 5px;
        margin: 2.5px;
        font-weight: 700;
    }

    .button:hover {
        cursor: pointer;
    }

    #enter {
        width: 65px;
    }

    #backspace {
        width: 65px;
    }

    header div {
        flex: 1;
    }

    #lastcontainer {
        display: flex;
        justify-content: flex-end;
    }

    .hidden {
        display: none;
    }

    #errorletter {
        position: fixed;
        width: 100%;
        text-align: center;
        color: red;
        background-color: black;
        padding: 8px 8px;
    }

    .yellow {
        background-color: #c9b458;
        border: none;
    }

    .green {
        background-color: #6aaa64;
        border: none;
    }

    .gray {
        background-color: #787c7e;
        border: none;
    }
    </style>
</head>

<body>
    <div id="errorletter" class="hidden">
        <h2>Non abbastanza lettere</h2>
    </div>
    <section id="all" class="container flex">
        <header>
            <div>
                <a href=""><img src="./images/interrogativo.svg"></a>
            </div>
            <div>
                <h1 id="title">WORDLE</h1>
            </div>
            <div id="lastcontainer">
                <a href="#"><img src="./images/classifica.svg"></a>
                <a href="#"><img src="./images/settings.svg"></a>
            </div>
        </header>
        <div>
            <div id="midcontainer">
                <div class="row">
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                </div>
                <div class="row">
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                </div>
                <div class="row">
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                </div>
                <div class="row">
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                </div>
                <div class="row">
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                </div>
                <div class="row">
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                    <div class="letterbox">
                    </div>
                </div>
            </div>
        </div>
        <div id="keyboard">
            <button class="button" data-letter="Q">Q</button>
            <button class="button" data-letter="W">W</button>
            <button class="button" data-letter="E">E</button>
            <button class="button" data-letter="R">R</button>
            <button class="button" data-letter="T">T</button>
            <button class="button" data-letter="Y">Y</button>
            <button class="button" data-letter="U">U</button>
            <button class="button" data-letter="I">I</button>
            <button class="button" data-letter="O">O</button>
            <button class="button" data-letter="P">P</button>
            <button class="button" data-letter="A">A</button>
            <button class="button" data-letter="S">S</button>
            <button class="button" data-letter="D">D</button>
            <button class="button" data-letter="F">F</button>
            <button class="button" data-letter="G">G</button>
            <button class="button" data-letter="H">H</button>
            <button class="button" data-letter="J">J</button>
            <button class="button" data-letter="K">K</button>
            <button class="button" data-letter="L">L</button>
            <button class="button enter" id="enter" data-letter="ENTER">ENTER</button>
            <button class="button" data-letter="Z">Z</button>
            <button class="button" data-letter="X">X</button>
            <button class="button" data-letter="C">C</button>
            <button class="button" data-letter="V">V</button>
            <button class="button" data-letter="B">B</button>
            <button class="button" data-letter="N">N</button>
            <button class="button" data-letter="M">M</button>
            <button class="button delete" id="backspace" data-letter="BACKSPACE"><img src="./images/backspace.svg"></button>
        </div>
    </section>
    <section id="settingspage" class="container hidden">
        <header>
        </header>
        <div>
            <di></di>
        </div>
        </div>
    </section>
    <script type="text/javascript">
    function getRandomInt(min, max) {
        min = Math.ceil(min);
        max = Math.floor(max);
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }


    let index = 0;
    let word = [];
    let erroreletter = document.querySelector("#errorletter")
    let vocabulary = ["citta", "treno", "isdft", "pausa"]
    let chosenword = vocabulary[0]
    let keyboardletters = document.querySelectorAll(".button")
    let rowindex = 0
    let currentRow = document.querySelectorAll('.row')[rowindex]
    let selectedWord = vocabulary[getRandomInt(0, vocabulary.length - 1)]
    let tentativi = 0
    let trovata = false

    function fillLetter(value) {
        word[index] = value



        currentRow.children[index].innerHTML = value
        index++
    }

    function checkWord() {
        let parolauser = ""
        if (word.length === 5) {
            for (let i = 0; i < word.length; i++) {
                parolauser = parolauser + word[i]
            }
            if (parolauser.toUpperCase() === chosenword.toUpperCase()) {
                console.log("TROVATA")
                trovata = true
                return true
            } else {
                console.log("NON TROVATA RIPROVA")
                trovata = false
                return false
            }
        } else {
            errorletter.classList.remove("hidden")
            setTimeout(function() {
                erroreletter.classList.add("hidden")
            }, 1250)
            return false
        }

    }


    

    function eraseLetter() {
        if (index > 0) {
            index--
            console.log(word)
            word.pop()
            currentRow.children[index].innerHTML = " "


        }



    }

    function checkinput(event) {
        let inseribile = true
        if (event >= 65 && event <= 90 || event === 13 || event === 8) {
            return inseribile
        } else {
            inseribile = false
            return inseribile
        }
    }

    function changerow() {
        if (rowindex < 5) {
            rowindex++
            currentRow = document.querySelectorAll('.row')[rowindex]
            word = []
            index = 0
        }
    }
    function colorelettere(){
        let uguale = false
        for(let s = 0; s<word.length;s++){
            let uguale = false
            for(let f = 0; f<word.length;f++){
                if (word[s].toUpperCase() === chosenword[f].toUpperCase()) {
                    currentRow.children[s].classList.remove("gray")
                    currentRow.children[s].classList.add("yellow")
                    uguale = true
                }else if(uguale===false){
                    currentRow.children[s].classList.add("gray")
                    currentRow.children[s].classList.remove("yellow")
                }
            }
        }
        for(let h = 0; h<word.length;h++){
            if (word[h].toUpperCase() === chosenword[h].toUpperCase()) {
                currentRow.children[h].classList.remove("yellow")
                currentRow.children[h].classList.remove("gray")
                currentRow.children[h].classList.add("green")
            }
        }
    }

    function checkwin() {
        if (trovata) {
            console.log("checkwin")
        } else if (tentativi === 5) {
            console.log("sei un pippone")
        }
    }
    document.addEventListener('keydown', function(e) {
        erroreletter.classList.add("hidden")
        if (checkinput(e.keyCode)) {
            if (e.key === 'Enter') {
                if (tentativi <= 5 && trovata === false) {
                    colorelettere()
                    if (checkWord()) {
                        checkwin()
                        console.log("gioco finito GG")
                    } else if (tentativi === 5) {
                        checkwin()
                    }
                    if (word.length === 5) {
                        tentativi++
                        changerow()
                    }
                }
            } else if (e.key === 'Backspace') {
                eraseLetter()
            } else if (index < 5 && trovata === false) {
                fillLetter(e.key)
            }
        }
    });
    for (let i = 0; i < keyboardletters.length; i++) {
        let key = keyboardletters[i]
        key.addEventListener("click", function(e) {
            let lettera = e.currentTarget.dataset.letter
            if (lettera === "BACKSPACE") {
                eraseLetter()
            } else if (lettera === "ENTER") {
                colorelettere()
                if (checkWord() && trovata === false) {
                    checkwin()
                    console.log("gioco finito GG")
                } else if (tentativi === 5) {
                    checkwin()
                }
                if (word.length === 5) {
                    tentativi++
                    changerow()
                }
            } else if (index < 5 && trovata === false) {
                fillLetter(lettera)
            }
        })
    }
    </script>
</body>

</html>